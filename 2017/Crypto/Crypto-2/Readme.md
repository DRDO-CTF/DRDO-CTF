
# DRDO CTF 2017 : Crypto-2

**Category:** Crypto

**Level:** Easy

**Points:** 50

**Solves:** 59

**Description:**

>Chief got a message without any information. Message looks like some **standard encoding** but chief has no expertise. Help the chief to get the message.<br/>
>CryptMessage:
`MDk3NDM1OTY1NjE2NTAyNDg5MTgyMzQ3MzMwMDU5NzU5ODY2NjAyMjg4NDg3NzI0MzIwNjMxOTAyODUzNzYwMzYwNzIwMDI4NzQ3MWNyeXB0OkZGNUY5QzQ3NEE5QTQ5OTdCMzc3NzFCODE3MDFEQTAzMDVGREUyQzM0QjZBQkNBQkE5MzkzQTA5REQwQkZGMzQ0NTU0NTAyMTMyMzg0OTc2ODk3MzE2Mjg0NDIxOTY3NzA1OTQ1MzIzMjY0ODA5NTAzNDIyODc5NTEwMzg0NTE4ODU2OTUzMTcyOTg0NDMxNjcxNDMxNTAzODkyMzEzMDYyODkxMzQ5NzE1MjAwNTEyNDcxNDk1OTcwMzg0ODcwNzMwMTU1MDE4NDUyMTA2NzQzMTQ3NjY4MzY3ODg3ODQ3OTU4OTU0NzQ3NDU3MTA3NjM3MDI3MzU2ODAxMzY1NTIyNTQ4MDkyNDIzNjMxMTQxMDcxNDY0MTA4NDE4MjYyMzYyODA4MDIzNzE4MDI2OTMwMTI3NDkzOTQyNDQ4OTI4NTg3NjE4MjU1MTE0ODMxOTkzMzMyOTA0MDkxMTM0ODEyMjA5MzA2Mjk1ODg1NzcyOTA3OTQzNTM1Mzc0NjYzMjg0NzkxNzc4NDY1MzMxMTI0MDUxMzA1MjAxMTczMTc5NTI0ODkzNTM2OTM0MTU0MTY5NzAzMDM1MTk1MTA3MjM1Mjc2MDM0MjA0NDA3MzEwMDA0NTkwNjgyNTAyNjk0NjkyOTUxMzg2NTgzMzM2a2V5On1ZTFBSRVdPUHtfTlVKUkE4MjIwNzM2Nzc3ODQ5MTU2OTY4MjQ4MDg0Mzc3NDUxODE0NDY3NDQ4MzQ4ODMwNDk3OTIwMjc1MTA2MTYyNTMzOTQ1NDM3OTczMTA0MzExOTcyOTgxMjk2ODEzNTk4Njk3MzgzOTQwMDM5NjY3OTMxNTUyMjU2NzE0OTUxMjUxODI4OTIxMTc5MTQ4MDU0OTg0MzUzODY0MDc5NTYwOTc5MDU0NjY0MjY3NTQ2MjQ4ODk1NjUzNDc2MTc0NjUxMDYwOTE1OTU1MDY0NTE3MTI1MTk1Njk3OTg5OTE5Mjk3OTQ2OTQ1MTI4NzMyMjAzOTU4MTc4NjU0MTM2MzE1NTg5NTY1NzMwMTk5NzUxMzkxODEyMjI1NjE3MjY2Mzk3OTcwNzMyNDcwMTYxMjkxODMxMzA0NDU1MzA3MTM4MTk3NzI3NzM4MzE4MTQxNTg1MDIwOTQ0MTczNzc1MDUxODUwNjAxNTcxNjk4NTEyODcxNTExMTA3Mzk4OTI1OTgxODk2ODc0NjAxNzc4MjM3NDQ4NjgzMzc5MjI1NjUxODAxNTY2NDM0ODQ1MDg2ODI2NDc4aGludDpTVEFOREFSREJMT0NLQ0lQSEVSS0VZUkVWRVJTRTU4NDA4OTY0MDAyMjg5Nzg1NTUwNjUzMDQwMjMzOTc3MzAyMTc5NDc3MjgxMzEzOTI4MDIxNDM1MDE1NjI=`


## Write-up

>1. Standard encoding indicates for base64 encoding.<br/>
>2. If you decode it using https://www.base64decode.org/, you will get:<br/>
`0974359656165024891823473300597598666022884877243206319028537603607200287471crypt:FF5F9C474A9A4997B37771B81701DA0305FDE2C34B6ABCABA9393A09DD0BFF344554502132384976897316284421967705945323264809503422879510384518856953172984431671431503892313062891349715200512471495970384870730155018452106743147668367887847958954747457107637027356801365522548092423631141071464108418262362808023718026930127493942448928587618255114831993332904091134812209306295885772907943535374663284791778465331124051305201173179524893536934154169703035195107235276034204407310004590682502694692951386583336key:}YLPREWOP{_NUJRA8220736777849156968248084377451814467448348830497920275106162533945437973104311972981296813598697383940039667931552256714951251828921179148054984353864079560979054664267546248895653476174651060915955064517125195697989919297946945128732203958178654136315589565730199751391812225617266397970732470161291831304455307138197727738318141585020944173775051850601571698512871511107398925981896874601778237448683379225651801566434845086826478hint:STANDARDBLOCKCIPHERKEYREVERSE5840896400228978555065304023397730217947728131392802143501562`
>From above text you can easily extract following information:<br/>
>* crypt:`FF5F9C474A9A4997B37771B81701DA0305FDE2C34B6ABCABA9393A09DD0BFF34` (32 bytes or 64 characters in hex)<br/>
>* key:`}YLPREWOP{\_NUJRA`<br/>
>* hint:*STANDARDBLOCKCIPHER***KEYREVERSE**<br/>
>3. From above hint it is clear that key needs to be reversed. Therefore key is `ARJUN_{POWERPLY}`
>   From Second hint it is clear that is is standard block cipher. Thefore we can try for DES or AES. We need to check every      variant of these block ciphers.<br/>
>4. After trying all vairant using http://aes.online-domain-tools.com/ it is found that the algorithm is AES-CBC-128 and `00` IV (if IV is not specified it should be consider all `00`, CBC mode is one of the standard modes of AES).<br/>
>   If we decrypt the above crypt with menitoned key `ARJUN_{POWERPLY}` with all `00` IV, it will output the flag.<br/>
>5. Flag is `DRDO@60_{A6S70R}_FLAG!`
   
## Python Program

```Python
import base64
crypt_encode= "MDk3NDM1OTY1NjE2NTAyNDg5MTgyMzQ3MzMwMDU5NzU5ODY2NjAyMjg4NDg3NzI0MzIwNjMxOTAyODUzNzYwMzYwNzIwMDI4NzQ3MWNyeXB0OkZGNUY5QzQ3NEE5QTQ5OTdCMzc3NzFCODE3MDFEQTAzMDVGREUyQzM0QjZBQkNBQkE5MzkzQTA5REQwQkZGMzQ0NTU0NTAyMTMyMzg0OTc2ODk3MzE2Mjg0NDIxOTY3NzA1OTQ1MzIzMjY0ODA5NTAzNDIyODc5NTEwMzg0NTE4ODU2OTUzMTcyOTg0NDMxNjcxNDMxNTAzODkyMzEzMDYyODkxMzQ5NzE1MjAwNTEyNDcxNDk1OTcwMzg0ODcwNzMwMTU1MDE4NDUyMTA2NzQzMTQ3NjY4MzY3ODg3ODQ3OTU4OTU0NzQ3NDU3MTA3NjM3MDI3MzU2ODAxMzY1NTIyNTQ4MDkyNDIzNjMxMTQxMDcxNDY0MTA4NDE4MjYyMzYyODA4MDIzNzE4MDI2OTMwMTI3NDkzOTQyNDQ4OTI4NTg3NjE4MjU1MTE0ODMxOTkzMzMyOTA0MDkxMTM0ODEyMjA5MzA2Mjk1ODg1NzcyOTA3OTQzNTM1Mzc0NjYzMjg0NzkxNzc4NDY1MzMxMTI0MDUxMzA1MjAxMTczMTc5NTI0ODkzNTM2OTM0MTU0MTY5NzAzMDM1MTk1MTA3MjM1Mjc2MDM0MjA0NDA3MzEwMDA0NTkwNjgyNTAyNjk0NjkyOTUxMzg2NTgzMzM2a2V5On1ZTFBSRVdPUHtfTlVKUkE4MjIwNzM2Nzc3ODQ5MTU2OTY4MjQ4MDg0Mzc3NDUxODE0NDY3NDQ4MzQ4ODMwNDk3OTIwMjc1MTA2MTYyNTMzOTQ1NDM3OTczMTA0MzExOTcyOTgxMjk2ODEzNTk4Njk3MzgzOTQwMDM5NjY3OTMxNTUyMjU2NzE0OTUxMjUxODI4OTIxMTc5MTQ4MDU0OTg0MzUzODY0MDc5NTYwOTc5MDU0NjY0MjY3NTQ2MjQ4ODk1NjUzNDc2MTc0NjUxMDYwOTE1OTU1MDY0NTE3MTI1MTk1Njk3OTg5OTE5Mjk3OTQ2OTQ1MTI4NzMyMjAzOTU4MTc4NjU0MTM2MzE1NTg5NTY1NzMwMTk5NzUxMzkxODEyMjI1NjE3MjY2Mzk3OTcwNzMyNDcwMTYxMjkxODMxMzA0NDU1MzA3MTM4MTk3NzI3NzM4MzE4MTQxNTg1MDIwOTQ0MTczNzc1MDUxODUwNjAxNTcxNjk4NTEyODcxNTExMTA3Mzk4OTI1OTgxODk2ODc0NjAxNzc4MjM3NDQ4NjgzMzc5MjI1NjUxODAxNTY2NDM0ODQ1MDg2ODI2NDc4aGludDpTVEFOREFSREJMT0NLQ0lQSEVSS0VZUkVWRVJTRTU4NDA4OTY0MDAyMjg5Nzg1NTUwNjUzMDQwMjMzOTc3MzAyMTc5NDc3MjgxMzEzOTI4MDIxNDM1MDE1NjI="

crypt_decode = base64.b64decode(crypt_encode) 

crypt = crypt_decode[82:82+64]
#output is FF5F9C474A9A4997B37771B81701DA0305FDE2C34B6ABCABA9393A09DD0BFF34
key_reverse = crypt_decode[580:580+16]
#output is }YLPREWOP{_NUJRA
hint = crypt_decode[1034:1063]
#output is : STANDARDBLOCKCIPHERKEYREVERSE
#Reverse the Key
key = key_reverse[::-1]
#output is : ARJUN_{POWERPLY}
#AES-128 Decryption
from Crypto.Cipher import AES
decryption_suite = AES.new(bytes(bytearray.fromhex(key.encode('hex'))), AES.MODE_CBC, 16 * '\x00')
decryption_suite.decrypt(bytes(bytearray.fromhex(crypt)))
#output is : 'DRDO@60_{A6S70R}_FLAG!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
```

